import{A as e}from"./api_user.0ee83d22.js";import{S as t}from"./vendor.194c4086.js";import{n as a}from"./index.c66ec47f.js";import"./index.dfdb83b1.js";import"./bus.d56574c1.js";const n={};var l=a({data(){return{loading:!1,account:{username:"",pwd:""},errmsgshow:!1,rules:{username:[{required:!0,validator:(e,t,a)=>{if(""!=t)a();else{a(this.$t("login.qing-shu-ru-zhang-hao"))}},trigger:"blur"}],pwd:[{required:!0,validator:(e,t,a)=>{if(""!=t)a();else{a(this.$t("login.qing-shu-ru-mi-ma"))}},trigger:"blur"}]},timeshow:1,checked:!0}},watch:{"account.username":{handler(e,t){"undefined"!=e&&1==this.errmsgshow&&(this.errmsgshow=!1)}},"account.pwd":{handler(e,t){"undefined"!=e&&1==this.errmsgshow&&(this.errmsgshow=!1)}}},methods:{handleLogin(){let a=this;this.$refs.AccountFrom.validate((n=>{if(n){this.loading=!0;let n={user_name:this.account.username};e.get_session(n).then((function(n){document.cookie="session_id="+n;let l=t(a.account.username+a.account.pwd+n).toString(),s={user_name:a.account.username,hash_value:l};a.errmsgshow=!1,e.login(s).then((function(e){e&&e.id?(localStorage.setItem("access-user",JSON.stringify(e)),a.loading=!1,a.$router.push({path:"/"})):a.$message.error({showClose:!0,message:e.errmsg||a.$t("login.deng-lu-shi-bai"),duration:2e3})}),(function(e){a.loading=!1,"invalid user name or password!"==e.response.data&&(a.errmsgshow=!0)})).catch((function(e){a.loading=!1,console.log(e),a.$message.error({showClose:!0,message:a.$t("login.qing-qiu-chu-xian-yi-chang"),duration:2e3})}))}),(function(e){a.loading=!1})).catch((function(e){a.loading=!1,console.log(e),a.$message.error({showClose:!0,message:a.$t("login.qing-qiu-chu-xian-yi-chang"),duration:2e3})}))}}))},ChineseFunc(e){this.clearLanguageClass(),e.target.style.color="#0070cc",localStorage.setItem("language_clup","cn"),this.$i18n.locale="cn",location.reload()},EnglishFunc(e){this.clearLanguageClass(),e.target.style.color="#0070cc",localStorage.setItem("language_clup","en"),this.$i18n.locale="en",location.reload()},clearLanguageClass(){let e=document.getElementsByClassName("language_cls");for(let t=0;t<e.length;t++)e[t].style.color="#505458"}},created(){let e=window.location.href.split("?")[1],t=new URLSearchParams(e);if(t.has("language"))switch(t.get("language")){case"0":this.$nextTick((()=>{let e=document.getElementsByClassName("language_cls");for(let t=0;t<e.length;t++)e[t].style.color="#505458";e[0].style.color="#0070cc",localStorage.setItem("language_clup","cn"),this.$i18n.locale="cn"}));break;case"1":this.$nextTick((()=>{let e=document.getElementsByClassName("language_cls");for(let t=0;t<e.length;t++)e[t].style.color="#505458";e[1].style.color="#0070cc",localStorage.setItem("language_clup","en"),this.$i18n.locale="en"}))}else this.$nextTick((()=>{let e=document.getElementsByClassName("language_cls");for(let t=0;t<e.length;t++)e[t].style.color="#505458";"en"==localStorage.getItem("language_clup")?(e[1].style.color="#0070cc",localStorage.setItem("language_clup","en"),this.$i18n.locale="en"):(e[0].style.color="#0070cc",localStorage.setItem("language_clup","cn"),this.$i18n.locale="cn")}))}},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"loginbg"}),a("el-form",{ref:"AccountFrom",staticClass:"demo-ruleForm login-container",attrs:{model:e.account,rules:e.rules,"label-position":"left","label-width":"0px"}},[a("h3",{staticClass:"title"},[e._v(e._s(e.$t("login.guan-li-yuan-deng-lu")))]),a("el-form-item",{staticStyle:{position:"absolute","margin-top":"-15px",right:"30px","z-index":"2"}},[a("span",{staticClass:"language_cls",on:{click:e.ChineseFunc}},[e._v(" "+e._s(e.$t("index.zhong-wen")))]),e._v("|"),a("span",{staticClass:"language_cls",on:{click:e.EnglishFunc}},[e._v(e._s(e.$t("index.ying-wen"))+" ")])]),a("el-form-item",{staticClass:"errorbox",attrs:{prop:"username"}},[a("el-input",{staticClass:"pushbtn",attrs:{type:"text","auto-complete":"off",placeholder:e.$t("login.zhang-hao")},model:{value:e.account.username,callback:function(t){e.$set(e.account,"username",t)},expression:"account.username"}})],1),a("el-form-item",{staticClass:"errorbox",attrs:{prop:"pwd"}},[a("el-input",{staticClass:"pushbtn",attrs:{type:"password","auto-complete":"off",placeholder:e.$t("login.mi-ma")},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin(t)}},model:{value:e.account.pwd,callback:function(t){e.$set(e.account,"pwd",t)},expression:"account.pwd"}})],1),a("div",{staticStyle:{height:"28px",overflow:"hidden"}},[e.errmsgshow?a("p",{staticStyle:{"text-align":"center",color:"red","font-size":"14px"}},[e._v(e._s(e.$t("login.yan-zheng-zhang-hao-message")))]):e._e()]),a("el-form-item",{staticStyle:{width:"100%"}},[a("el-button",{staticStyle:{width:"100%",height:"40px","margin-top":"20px"},attrs:{type:"primary",loading:e.loading},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin(t)}}},[e._v(e._s(e.$t("login.deng-lu")))])],1)],1)],1)}),[],!1,s,"0b4c767a",null,null);function s(e){for(let t in n)this[t]=n[t]}var o=function(){return l.exports}();export{o as default};
