var t=Object.defineProperty,e=Object.defineProperties,a=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,n=(e,a,i)=>a in e?t(e,a,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[a]=i,o=(t,e)=>{for(var a in e||(e={}))s.call(e,a)&&n(t,a,e[a]);if(i)for(var a of i(e))l.call(e,a)&&n(t,a,e[a]);return t};"undefined"!=typeof require&&require;import{p as r}from"./polarDbComputerRoomConfig.260ce1ec.js";import{c as d,a as c}from"./computerRoomConfig.517d1137.js";import{A as u}from"./api_clusterManage.333bcab0.js";import{e as p}from"./vendor.194c4086.js";import{n as h,_ as g}from"./index.e6909a03.js";import{a as b}from"./verificationRules.28629627.js";import _ from"./taskLog.8883e917.js";import{f as m}from"./staticTools.7d79b9f2.js";import{b as f}from"./bus.d56574c1.js";import"./index.dfdb83b1.js";const w={};var y=h({name:"clusterRelation",components:{},data(){return{clusterState:this.$route.query.cluster_state,loading:!1,data:[],myChart1:"",option:{},symbolImg:"image:///images/db.png"}},methods:{getClusterRelation:function(){const t=this;let e={cluster_id:t.$route.query.cluster_id};console.log(this.symbolImg),u.getDBRelation(e).then((function(e){t.data=e,t.myChart1=p.init(document.getElementById("container"));var a=.1*document.body.clientWidth;t.myChart1.setOption(t.option={tooltip:{trigger:"item",triggerOn:"mousemove",formatter:function(e){var a="";console.log(e.data.state,1===e.data.state),a=1===e.data.state?'<span style="color:#00A600">Normal</span>':2===e.data.state?'<span style="color:red">Fault</span>':3===e.data.state?"Failover":4===e.data.state?"Switching":5===e.data.state?"Repairing":"Unknow";var i=e.data.host,s=t.$t("clusterRelation.shujuku-message")+e.data.db_id,l=t.$t("clusterRelation.shujumulu-message")+e.data.pgdata;return i+s+(t.$t("clusterRelation.youxianji-message")+e.data.scores)+(t.$t("clusterRelation.jifang-message")+("默认机房"==e.data.room_name?t.$t("dbList.moren-jifang"):e.data.room_name))+(t.$t("clusterRelation.zhuangtai-message")+a)+l}},series:[{type:"tree",data:[t.data],left:"2%",right:"2%",top:"15%",bottom:"20%",symbol:t.symbolImg,symbolSize:a,expandAndCollapse:!0,orient:"vertical",initialTreeDepth:-1,roam:"move",animationDurationUpdate:750,label:{rotate:0,verticalAlign:"middle",align:"center",normal:{show:!0,fontSize:.07*a,position:"insideBottom",distance:17,padding:5,lineHeight:.09*a,borderWidth:.2*a,borderType:"solid",borderRadius:7,backgroundColor:"#ffffffe3",opacity:.8,formatter:function(e){var a="";console.log(e.data.state,1===e.data.state);var i="";return 1===e.data.state?(a="Normal",i="a"):2===e.data.state?(a="Fault",i="b"):a=3===e.data.state?"Failover":4===e.data.state?"Switching":5===e.data.state?"Repairing":"Unknow",e.data.host+(t.$t("clusterRelation.shujukku-message")+e.data.db_id)+(t.$t("clusterRelation.jifang-message-two")+("默认机房"==e.data.room_name?t.$t("dbList.moren-jifang"):e.data.room_name))+(t.$t("clusterRelation.youxianji-message-two")+e.data.scores)+(t.$t("clusterRelation.zhuangtai-message-two")+"{"+i+"|"+a+"}")},rich:{a:{fontSize:.07*a,color:"#00A600",fontFamily:"Microsoft YaHei"},b:{fontSize:.07*a,color:"red",fontFamily:"Microsoft YaHei"}}}}}]})}),(function(e){t.loading=!1}))}},mounted:function(){let t=this;this.getClusterRelation(),window.onresize=()=>{t.myChart1.resize()}},destroyed(){clearInterval(this.intervalID)}},(function(){var t=this;t.$createElement;return t._self._c,t._m(0)}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("div",{staticStyle:{"min-height":"600px"},attrs:{id:"container"}})])}],!1,$,"bcacee62",null,null);function $(t){for(let e in w)this[e]=w[e]}var v=function(){return y.exports}();const k={};var x=h({name:"dbList",components:{taskLog:_,modifyDatabaseHaStateDialog:()=>g((()=>import("./ModifyDatabaseHaStateDialog.3acffe4b.js")),["assets/ModifyDatabaseHaStateDialog.3acffe4b.js","assets/taskLog.1080e727.css","assets/api_clusterManage.333bcab0.js","assets/index.dfdb83b1.js","assets/vendor.194c4086.js","assets/bus.d56574c1.js","assets/index.e6909a03.js","assets/index.cbcfa343.css"])},data(){return{initialQueryParmsObj:{},clusterState:"",rows:[],dialogVisible:!1,total:0,page:1,size:10,oldpage:1,loading:!1,addFormVisible:!1,addFormRules:{host:[{required:!0,message:this.$t("polarDbEditDBList.qingshuru-shujuku-suozai-message"),trigger:"blur"}],repl_ip:[{required:!0,message:this.$t("polarDbEditDBList.qingshuru-shujuku-liufuzhi-message"),trigger:"blur"}],pgdata:[{required:!0,message:this.$t("defineDatabasePage.shuju-mulu-placeholder"),trigger:"blur"}]},addForm:{},currentRow:"",editFormVisible:!1,editFormRules:{host:[{required:!0,message:this.$t("polarDbEditDBList.qingshuru-shujuku-suozai-message"),trigger:"blur"}],repl_ip:[{required:!0,message:this.$t("polarDbEditDBList.qingshuru-shujuku-liufuzhi-message"),trigger:"blur"}],pgdata:[{required:!0,message:this.$t("defineDatabasePage.shuju-mulu-placeholder"),trigger:"blur"}]},nowData:{},istrue:!0,is_rebuild:!1,is_rewind:!1,checkRadio:0,editForm:{},checkfun:"1",standbyDbForm:{tblspc_dir:[]},standbyDbFormRules:{old_dir:[{required:!1,validator:b,trigger:"blur"}],new_dir:[{required:!1,validator:b,trigger:"blur"}]},cascadedRows:[],cascadedDialogVisible:!1,db_state:0,cur_db:"",dialogLoading:!1,dbTableRadio:"",cluster_id:"",clusterType:1,clupBtn:["import","create","distribution","del","standby","active","switch","stop","start","edit","create","restart","change","cancel","kill","cancel","kill","detail","create","import","del","standby","edit","see","offLine","onLine","detail","detail","plan","backup","detail","del","edit","import","del","detail","log","recovery","log","monitor","open","start","edit","del","add","edit","del","see","edit","offLine","edit","startClass","stopClass","host","database","session","lock","modify","move","upgrade","bounce"],language:""}},watch:{is_rewind:function(t){t||(this.is_rebuild=!1)},is_rebuild:function(t){t&&(this.is_rewind=!0)}},methods:{funChandleClick:function(t){const e=this;let a="",i=window.location.href.split("?")[1],s=new URLSearchParams(i);s.has("hidmenu")&&(a=s.get("hidmenu")),"conversation"==t.type?e.wantConversationBtn(t.row,a):"lock"==t.type&&e.wantLockBtn(t.row,a)},wantConversationBtn:function(t,e){this.$router.push({path:"/SessionManage",query:o({data:t},""!=e&&{hidmenu:e})})},wantLockBtn:function(t,e){this.$router.push({path:"/lockManage",query:o({data:t},""!=e&&{hidmenu:e})})},composeValue:(t,e,a)=>({type:t,index:e,row:a}),tableRowClassName:({row:t,rowIndex:e})=>e%2!=0?"warning-row":"success-row",addTableSpace(){this.standbyDbForm.tblspc_dir.push({old_dir:"",new_dir:"",check:!0})},delTblSpc(t){this.standbyDbForm.tblspc_dir.splice(t,1)},handleSizeChange(t){this.size=t,this.oldpage=this.page,this.showdbList()},handleCurrentChange(t){this.page=t,this.oldpage=this.page,this.showdbList()},showdbList:function(){let t=this;t.loading=!0;let e={page_size:this.$queryProps.page_size,page_num:this.$queryProps.page_num,cluster_id:this.$queryProps.cluster_id};u.getdbList(e).then((function(e){t.loading=!1,e&&e.rows&&(t.total=e.total,t.rows=e.rows,null!=t.$refs.pagination&&(t.$refs.pagination.internalCurrentPage=t.oldpage)),t.$nextTick((()=>{let e=window.location.href.split("?")[1],a=new URLSearchParams(e);if(a.has("hidmenu")){let e=a.get("hidmenu").split(","),i=t.clupBtn.filter((t=>e.indexOf(t)<0));for(let t=0;t<i.length;t++){let e=document.getElementsByClassName(""+i[t]);for(let t=0;t<e.length;t++)e[t].setAttribute("style","display:none")}}}))}),(function(e){t.loading=!1}))},SrClusterSwitch:function(t,e){let a=this;this.$createElement;let i='<div style="overflow:hidden;display:flex;align-items: center;"><div style="float:left;position: relative;height: 40px;width: 40px;"><div class ="el-message-box__status el-icon-warning"></div></div><div style="float:left"><p>'+a.$t("dbList.ninqueding-yaojiangshujuku-message")+e.db_id+a.$t("dbList.tishengwei-zhukema");11!=e.db_type&&(i+="<p><p>"+a.$t("dbList.shufoubaoliu-zhubeiku-message")+'</p><p id="p" style="display:inline-block"><input class="ischeckInput" name="ischeckInput" type="radio" id="cluster_manage_confirm_promote_keep_cascade" value=true> <label for="r">'+a.$t("dbList.shi")+'</label></p>   <p id="p" style="display:inline-block"><input type="radio" checked  name="ischeckInput"  class="ischeckInput" id="a" value=false> <label for="a">'+a.$t("dbList.fou")+"</label></p></div>"),i+="</div>",this.$confirm(i,a.$t("index.ti-shi"),{dangerouslyUseHTMLString:!0,closeOnClickModal:!1}).then((({value:t})=>{a.loading=!0;let i={cluster_id:e.cluster_id,db_id:e.db_id,keep_cascaded:!1};if(11==e.db_type&&u.polarSwitch(i).then((function(t){a.loading=!1,a.$refs.tasklog.openDialog(t.task_id,a.showdbList,2),a.showdbList()}),(function(t){a.loading=!1})),21==a.clusterType){let t={db_id:e.db_id,cluster_id:e.cluster_id};u.patroniSwitchover(t).then((function(t){a.loading=!1,a.showdbList()}),(function(t){a.loading=!1}))}else document.getElementById("cluster_manage_confirm_promote_keep_cascade").checked&&(i.keep_cascaded=!0,console.log("keep_cascaded is true .")),u.srSwitch(i).then((function(t){a.loading=!1,a.$refs.tasklog.openDialog(t.task_id,a.showdbList,2),a.showdbList()}),(function(t){a.loading=!1}))})).catch((t=>{console.log("提升数据库为主库时前端发生错误：",t)}))},clickChange(t){this.dbTableRadio=t,console.log(t)},allCascadeDbDialog:function(t){const e=this;e.checkfun="1",console.log(e.checkfun);let a={db_id:t.db_id,cluster_id:t.cluster_id};console.log(t),this.cluster_id=t.cluster_id,e.cur_db=t.db_id,e.cascadedDialogVisible=!0,this.dialogLoading=!0,u.getClusterAllDb(a).then((function(a){if(e.dialogLoading=!1,11==t.db_type&&"reader"==t.polar_type){let t=[],i=a;for(let e=0;e<i.length;e++)null==i[e].up_db_id&&t.push(i[e]);e.cascadedRows=t}else e.cascadedRows=a}),(function(t){e.dialogLoading=!1}))},checkReturnFun:function(t,e){const a=this;a.checkfun=t,a.checkRadio=0;let i="";i=2==t?e.db_id:a.dbTableRadio.db_id;let s={db_id:i};console.log(s.db_id),u.getMasterInfo(s).then((function(t){let i=[];for(let e=0;e<t.tblspc_dir.length;e++){let a={old_dir:t.tblspc_dir[e].old_dir,new_dir:t.tblspc_dir[e].new_dir,check:!1};i.push(a)}0==t.tblspc_dir.length&&i.push({old_dir:"",new_dir:"",check:!0}),a.standbyDbForm.tblspc_dir=i,a.dialogVisible=!0,a.nowData=e}),(function(t){a.dialogLoading=!1}))},repairDbFromCluster:function(t,e){let a=this;a.loading=!0;let i=Object.assign({},a.standbyDbForm),s={cluster_id:this.cluster_id,db_id:this.cur_db,up_db_id:this.dbTableRadio.db_id,is_rewind:a.is_rewind,is_rebuild:a.is_rebuild};if("2"==a.checkfun&&(s={cluster_id:a.nowData.cluster_id,db_id:a.nowData.db_id,up_db_id:a.nowData.up_db_id,is_rewind:a.is_rewind,is_rebuild:a.is_rebuild},null!=s.up_db_id&&""!=s.up_db_id&&null!=s.up_db_id||(s.up_db_id=0)),i.tblspc_dir.length>1)for(let l=0;l<i.tblspc_dir.length;l++){if(""==i.tblspc_dir[l].old_dir&&""==i.tblspc_dir[l].new_dir&&(i.tblspc_dir.splice(l,1),l--),""!=i.tblspc_dir[l].old_dir&&""==i.tblspc_dir[l].new_dir)return void a.$message({type:"error",message:a.$t("createStandbyPage.biaokongjian-xinjiu-message")});if(""==i.tblspc_dir[l].old_dir&&""!=i.tblspc_dir[l].new_dir)return void a.$message({type:"error",message:a.$t("createStandbyPage.biaokongjian-xinjiu-message")})}else if(1==i.tblspc_dir.length)if(""==i.tblspc_dir[0].old_dir&&""==i.tblspc_dir[0].new_dir)i.tblspc_dir.splice(0,1);else if(""!=i.tblspc_dir[0].old_dir&&""==i.tblspc_dir[0].new_dir||""==i.tblspc_dir[0].old_dir&&""!=i.tblspc_dir[0].new_dir)return void a.$message({type:"error",message:a.$t("createStandbyPage.biaokongjian-xinjiu-message")});s.rm_pgdata=a.checkRadio,s.tblspc_dir=a.standbyDbForm.tblspc_dir,a.cascadedDialogVisible=!1,a.dialogVisible=!1,u.repair(s).then((function(t){a.loading=!1,a.$refs.tasklog.openDialog(t.task_id,a.showdbList,3),setTimeout(a.showdbList,700)}),(function(t){a.loading=!1}))},startDatabase:function(t,e){let a=this;this.$confirm(a.$t("dbList.ninquedingyao-qidongjiqi")+e.host+a.$t("dbList.shangdeshujuku-message")+e.db_id+")?",a.$t("index.ti-shi"),{type:"warning",closeOnClickModal:!1}).then((()=>{a.loading=!0;let t={db_id:e.db_id};u.startPostgres(t).then((function(t){a.loading=!1,a.showdbList()}),(function(t){a.loading=!1}))})).catch((t=>{}))},stopDatabase:function(t,e){let a=this;this.$confirm(a.$t("dbList.ninquedingyao-tingzhijiqi")+e.host+a.$t("dbList.shangdeshujuku-message")+e.db_id+")?",a.$t("index.ti-shi"),{type:"warning",closeOnClickModal:!1}).then((()=>{a.loading=!0;let t={db_id:e.db_id};u.stopPostgres(t).then((function(t){a.loading=!1,a.showdbList()}),(function(t){a.loading=!1}))})).catch((t=>{}))},showModifyDatabaseHaStateDialog:function(t){console.log(t),this.$refs.modifyDatabaseHaStateDialog.openDialog(t)}},mounted:function(){this.showdbList(),this.language=localStorage.getItem("language_clup"),this.clusterState=this.$queryProps.state,this.clusterType=this.$queryProps.cluster_type,this.initialQueryParmsObj=this.$queryProps.query},destroyed(){clearInterval(this.intervalID)}},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",[a("el-col",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{"row-class-name":t.tableRowClassName,data:t.rows,border:"","element-loading-text":t.$t("Public.ping-ming-jia-zai-zhong")}},[a("el-table-column",{attrs:{prop:"db_id",label:t.$t("switchDatabasePage.shujuku-ID"),align:"center","min-width":"80px"}}),a("el-table-column",{attrs:{prop:"up_db_id",label:t.$t("polarDbEditDBList.shangji-zhuku"),align:"center","min-width":"en"==t.language?"100px":"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return[2!==e.row.state?a("span",[t._v(" "+t._s(e.row.up_db_id)+" ")]):t._e(),2==e.row.state?a("del",{staticStyle:{"text-decoration":"line-through",color:"#000"}},[a("span",{staticStyle:{color:"#9a9a9a"}},[t._v(" "+t._s(e.row.up_db_id)+" ")])]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"state",label:t.$t("polarDbEditDBList.HA-zhuangtai"),align:"center","min-width":"90px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-link",{attrs:{type:1==e.row.state?"success":"warning"},on:{click:function(a){return t.showModifyDatabaseHaStateDialog(e.row)}}},[1===e.row.state?a("i",{staticClass:"el-icon-s-flag green"},[a("span",{staticClass:"statefont"},[t._v(" Normal")])]):2===e.row.state?a("i",{staticClass:"el-icon-error red"},[a("span",{staticClass:"statefont"},[t._v(" Fault")])]):3===e.row.state?a("span",[a("i",{staticClass:"el-icon-loading"}),t._v(" "),a("span",{staticClass:"statefont"},[t._v(" Failover")])]):4===e.row.state?a("span",[a("i",{staticClass:"el-icon-loading black"}),a("span",{staticClass:"statefont"},[t._v(" Switching")])]):5===e.row.state?a("span",[a("i",{staticClass:"el-icon-loading green"}),t._v(" "),a("span",{staticClass:"statefont"},[t._v(" Repairing")])]):t._e()])]}}])}),11!=t.clusterType?a("el-table-column",{attrs:{prop:"is_primary",label:t.$t("dbList.zhu-bei-ku"),align:"center","min-width":"110px"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.is_primary&&2!==e.row.state?a("span",[t._v(" "+t._s(t.$t("replDelay.zhu")))]):t._e(),0===e.row.is_primary&&2!==e.row.state?a("span",[t._v(" "+t._s(t.$t("replDelay.bei")))]):t._e(),1===e.row.is_primary&&2==e.row.state?a("del",{staticStyle:{"text-decoration":"line-through",color:"#000"}},[a("span",{staticStyle:{color:"#9a9a9a"}},[t._v(t._s(t.$t("replDelay.zhu")))])]):t._e(),0===e.row.is_primary&&2==e.row.state?a("del",{staticStyle:{"text-decoration":"line-through",color:"#000"}},[a("span",{staticStyle:{color:"#9a9a9a"}},[t._v(t._s(t.$t("replDelay.bei")))])]):t._e()]}}],null,!1,1294769364)}):t._e(),11==t.clusterType?a("el-table-column",{attrs:{prop:"is_primary",label:t.$t("dbList.zhu-bei-ku"),align:"center","min-width":"110px"},scopedSlots:t._u([{key:"default",fn:function(e){return["master"===e.row.polar_type&&2!==e.row.state?a("span",[t._v(" master")]):t._e(),"standby"===e.row.polar_type&&2!==e.row.state?a("span",[t._v(" standby")]):t._e(),"reader"===e.row.polar_type&&2!==e.row.state?a("span",[t._v(" reader")]):t._e(),"master"===e.row.polar_type&&2==e.row.state?a("del",{staticStyle:{"text-decoration":"line-through",color:"#000"}},[a("span",{staticStyle:{color:"#9a9a9a"}},[t._v(t._s(t.$t("replDelay.zhu")))])]):t._e(),"standby"===e.row.polar_type&&2==e.row.state?a("del",{staticStyle:{"text-decoration":"line-through",color:"#000"}},[a("span",{staticStyle:{color:"#9a9a9a"}},[t._v("standby")])]):t._e(),"reader"===e.row.polar_type&&2==e.row.state?a("del",{staticStyle:{"text-decoration":"line-through",color:"#000"}},[a("span",{staticStyle:{color:"#9a9a9a"}},[t._v("reader")])]):t._e()]}}],null,!1,3518727660)}):t._e(),a("el-table-column",{attrs:{prop:"host",label:t.$t("replDelay.suozai-zhuji"),align:"center","min-width":"135px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-dropdown",{attrs:{trigger:"click"},on:{command:t.funChandleClick}},[a("span",{staticClass:"el-dropdown-link",staticStyle:{color:"#0070cc","font-weight":"500"}},[t._v(" "+t._s(e.row.host)),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{staticClass:"session",attrs:{command:t.composeValue("conversation",e.$index,e.row)}},[t._v(t._s(t.$t("dbList.huihua-jiankong")))]),a("el-dropdown-item",{staticClass:"lock",attrs:{command:t.composeValue("lock",e.$index,e.row)}},[t._v(t._s(t.$t("dbList.suo-guan-li")))])],1)],1)]}}])}),a("el-table-column",{attrs:{prop:"room_name",label:t.$t("polarDbEditDBList.suozai-jifang"),align:"center","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",{staticClass:"statefont"},[t._v(" "+t._s("默认机房"==e.row.room_name?t.$t("dbList.moren-jifang"):e.row.room_name))])]}}])}),a("el-table-column",{attrs:{prop:"repl_ip",label:t.$t("polarDbEditDBList.liufuzhi-IP"),align:"center","min-width":"130px"}}),a("el-table-column",{attrs:{prop:"pgdata",label:t.$t("defineDatabasePage.shuju-mulu"),align:"center","min-width":"160px","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{prop:"scores",label:t.$t("createStreamReplicationCluster.youxianji"),align:"center","min-width":"60px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(" "+t._s(null==e.row.scores?"0":e.row.scores))])]}}])}),a("el-table-column",{attrs:{prop:"state",label:t.$t("dbList.shujuku-zhuangtai"),align:"center","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return[2===e.row.db_state?a("span",[a("i",{staticClass:"el-icon-loading"}),a("span",{staticClass:"statefont"},[t._v(" "+t._s(t.$t("dbList.chuang-jian-zhong")))])]):t._e(),0===e.row.db_state?a("i",{staticClass:"el-icon-success green"},[a("span",{staticClass:"statefont"},[t._v(" "+t._s(t.$t("dbList.yun-xing-zhong")))])]):1===e.row.db_state?a("i",{staticClass:"el-icon-info"},[a("span",{staticClass:"statefont"},[t._v(" "+t._s(t.$t("dashboard.ting-zhi")))])]):t._e(),3===e.row.db_state?a("span",[a("i",{staticClass:"el-icon-loading"}),a("span",{staticClass:"statefont"},[t._v(" "+t._s(t.$t("dbList.hui-fu-zhong")))])]):-1===e.row.db_state?a("i",{staticClass:"el-icon-warning orange"},[a("span",{staticClass:"statefont"},[t._v(" "+t._s(t.$t("dbList.agent-yichang")))])]):4===e.row.db_state?a("i",{staticClass:"el-icon-error red"},[a("span",{staticClass:"statefont"},[t._v(t._s(t.$t("dbLists.chuangjian-shibai")))])]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"handle",label:t.$t("clusterDefine.caozuo"),align:"center","min-width":"165px"},scopedSlots:t._u([{key:"default",fn:function(e){return[21!=t.clusterType&&5!=t.clusterState?a("span",[0===e.row.is_primary?a("span",[a("task-log",{ref:"tasklog"}),1===e.row.state&&-1!=e.row.db_state&&"standby"!=e.row.polar_type?a("el-link",{staticClass:"switch",attrs:{size:"mini"},on:{click:function(a){return t.SrClusterSwitch(e.$index,e.row)}}},[t._v(t._s(t.$t("dbList.qiehuanwei-zhuku")))]):2===e.row.state&&-1!=e.row.db_state?a("el-link",{staticClass:"add",attrs:{size:"mini"},on:{click:function(a){return t.allCascadeDbDialog(e.row)}}},[t._v(t._s(t.$t("dbList.jiahui-jiqun")))]):t._e()],1):0!==e.row.is_primary?a("span",[2===e.row.state?a("el-link",{staticClass:"add",attrs:{size:"mini"},on:{click:function(a){return t.checkReturnFun("2",e.row)}}},[t._v(" "+t._s(t.$t("dbList.jiahui-jiqun")))]):t._e()],1):t._e()]):t._e(),21==t.clusterType?a("span",[a("task-log",{ref:"tasklog"}),0===e.row.is_primary?a("span",[a("task-log",{ref:"tasklog"}),1===e.row.state&&-1!=e.row.db_state?a("el-link",{staticClass:"switch",attrs:{size:"mini"},on:{click:function(a){return t.SrClusterSwitch(e.$index,e.row)}}},[t._v(t._s(t.$t("dbList.qiehuanwei-zhuku")))]):t._e()],1):0!==e.row.is_primary?a("span"):t._e()],1):t._e(),1===e.row.db_state&&5!=t.clusterState?a("el-link",{staticClass:"start",attrs:{size:"mini",disabled:2===e.row.state&&-1!=e.row.db_state},on:{click:function(a){return t.startDatabase(e.$index,e.row)}}},[t._v(t._s(t.$t("dbList.qi-dong")))]):t._e(),0===e.row.db_state&&5!=t.clusterState?a("el-link",{staticClass:"stop",attrs:{size:"mini"},on:{click:function(a){return t.stopDatabase(e.$index,e.row)}}},[t._v(t._s(t.$t("dashboard.ting-zhi")))]):t._e()]}}])})],1),a("modify-database-ha-state-dialog",{ref:"modifyDatabaseHaStateDialog",on:{setDatabaseHaStateFinished:t.showdbList}}),a("el-dialog",{attrs:{title:t.$t("dbList.xuanze-shangjiku"),"append-to-body":!0,visible:t.cascadedDialogVisible,width:"40%"},on:{"update:visible":function(e){t.cascadedDialogVisible=e}}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dialogLoading,expression:"dialogLoading"}],staticStyle:{width:"100%"},attrs:{"row-class-name":t.tableRowClassName,data:t.cascadedRows,border:"","highlight-current-row":""},on:{"current-change":t.clickChange}},[a("el-table-column",{attrs:{label:t.$t("switchDatabasePage.xuan-ze"),width:"55"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-radio",{attrs:{label:e.row},model:{value:t.dbTableRadio,callback:function(e){t.dbTableRadio=e},expression:"dbTableRadio"}},[a("i")])]}}])}),a("el-table-column",{attrs:{prop:"db_id",label:t.$t("switchDatabasePage.shujuku-ID"),align:"center",width:"100px"}}),a("el-table-column",{attrs:{prop:"up_db_id",label:t.$t("polarDbEditDBList.shangji-zhuku"),align:"center",width:"en"==t.language?"110px":"70px"}}),a("el-table-column",{attrs:{prop:"host",label:t.$t("dashboard.zhu-ji"),align:"center","min-width":"120px"}}),a("el-table-column",{attrs:{prop:"port",label:t.$t("dashboard.duan-kou"),align:"center","min-width":"80px"}}),a("el-table-column",{attrs:{prop:"db_state",label:t.$t("dbList.zhuang-tai"),align:"left","header-align":"center","min-width":"90px"},scopedSlots:t._u([{key:"default",fn:function(e){return[0===e.row.db_state?a("i",{staticClass:"el-icon-success green"},[a("span",{staticClass:"statefont"},[t._v(" "+t._s(t.$t("dbList.yun-xing-zhong")))])]):1===e.row.db_state?a("i",{staticClass:"el-icon-info"},[a("span",{staticClass:"statefont"},[t._v(" "+t._s(t.$t("dashboard.ting-zhi")))])]):-1===e.row.db_state?a("i",{staticClass:"el-icon-error red"},[a("span",{staticClass:"statefont"},[t._v(" "+t._s(t.$t("dashboard.yi-chang")))])]):t._e()]}}])})],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[0!==t.db_state?a("span",{staticClass:"red",staticStyle:{"margin-right":"10px"}},[t._v(t._s(t.$t("switchDatabasePage.shujuiku-message")))]):t._e(),a("el-button",{on:{click:function(e){t.cascadedDialogVisible=!1}}},[t._v(t._s(t.$t("switchDatabasePage.qu-xiao")))]),a("el-button",{attrs:{type:"primary",disabled:!t.dbTableRadio},on:{click:function(e){return t.checkReturnFun("1")}}},[t._v(t._s(t.$t("switchDatabasePage.que-ding")))])],1)],1),a("el-dialog",{attrs:{"append-to-body":!0,title:t.$t("dbList.jiahui-jiqun"),visible:t.dialogVisible,width:"20%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticStyle:{"margin-left":"50px","font-size":"14px"}},[a("label",{staticStyle:{"margin-right":"20px"}},[t._v("1.")]),a("el-checkbox",{attrs:{disabled:""},model:{value:t.istrue,callback:function(e){t.istrue=e},expression:"istrue"}},[t._v(t._s(t.$t("dbList.jiancha-liufuzhi-zhuangtai")))]),a("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:t.$t("dbList.zhijiancha-liufuzhide-zhuangtai-message"),placement:"top-start"}},[a("i",{staticClass:"el-icon-question",staticStyle:{"margin-left":"10px",color:"#afaeae"}})])],1),a("div",{staticStyle:{"margin-left":"50px","font-size":"14px"}},[a("label",{staticStyle:{"margin-right":"20px"}},[t._v("2.")]),a("el-checkbox",{model:{value:t.is_rewind,callback:function(e){t.is_rewind=e},expression:"is_rewind"}},[t._v(t._s(t.$t("dbList.shiyong-pg_rewind-huifu")))]),a("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:t.$t("dbList.ruguojiancha-liufuzhi-message"),placement:"top-start"}},[a("i",{staticClass:"el-icon-question",staticStyle:{"margin-left":"10px",color:"#afaeae"}})])],1),a("div",{staticStyle:{"margin-left":"50px","font-size":"14px"}},[a("label",{staticStyle:{"margin-right":"20px"}},[t._v("3.")]),a("el-checkbox",{model:{value:t.is_rebuild,callback:function(e){t.is_rebuild=e},expression:"is_rebuild"}},[t._v(t._s(t.$t("polarDbEditDBList.chongxindajian-beiku")))]),a("el-tooltip",{staticClass:"item",attrs:{"open-delay":1e3,effect:"dark",content:t.$t("dbList.ruguo-jiancha-message"),placement:"top-start"}},[a("i",{staticClass:"el-icon-question",staticStyle:{"margin-left":"10px",color:"#afaeae"}})]),t.is_rebuild?a("div",{staticStyle:{"margin-left":"60px","font-size":"14px",display:"inline-block"}},[a("el-radio",{attrs:{label:0},model:{value:t.checkRadio,callback:function(e){t.checkRadio=e},expression:"checkRadio"}},[t._v(t._s(t.$t("polarDbEditDBList.chongmingming-jiude-shujuku")))]),a("el-radio",{staticStyle:{"margin-right":"80px"},attrs:{label:1},model:{value:t.checkRadio,callback:function(e){t.checkRadio=e},expression:"checkRadio"}},[t._v(t._s(t.$t("polarDbEditDBList.shanchu-yuanyou-shujumulu")))])],1):t._e()],1),a("el-form",{ref:"standbyDbForm",attrs:{model:t.standbyDbForm,"label-width":"100px",rules:t.standbyDbFormRules}},[a("el-row",{staticStyle:{color:"#606266","font-weight":"700","margin-bottom":"10px","margin-top":"10px"}},[a("el-col",{staticStyle:{"font-size":"12px"},attrs:{span:2.5}},[t._v(" "+t._s(t.$t("createStandbyPage.biaokongjian-mulu-yingshe"))+" ")])],1),t._l(t.standbyDbForm.tblspc_dir,(function(e,i){return a("el-row",{key:i},[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{size:"mini",label:t.$t("createStandbyPage.jiu-mu-lu"),prop:"tblspc_dir."+i+".old_dir",rules:t.standbyDbFormRules.old_dir}},[a("el-input",{attrs:{disabled:!e.check,placeholder:t.$t("createStandbyPage.shuru-jinbiao-message")},model:{value:e.old_dir,callback:function(a){t.$set(e,"old_dir",a)},expression:"item.old_dir"}})],1)],1),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{size:"mini",label:t.$t("createStandbyPage.xin-mu-lu"),prop:"tblspc_dir."+i+".new_dir",rules:t.standbyDbFormRules.new_dir}},[a("el-input",{attrs:{placeholder:t.$t("createStandbyPage.qingshu-xinbiao-message")},model:{value:e.new_dir,callback:function(a){t.$set(e,"new_dir",a)},expression:"item.new_dir"}})],1)],1),e.check&&t.standbyDbForm.tblspc_dir.length>1?a("i",{staticClass:"el-icon-remove-outline",staticStyle:{float:"left","line-height":"30px","margin-left":"10px","font-size":"20px",cursor:"pointer"},on:{click:function(e){return t.delTblSpc(i)}}}):t._e(),i+1==t.standbyDbForm.tblspc_dir.length?a("i",{staticClass:"el-icon-circle-plus-outline",staticStyle:{float:"left","line-height":"30px","margin-left":"10px","font-size":"20px",cursor:"pointer"},on:{click:t.addTableSpace}}):t._e()],1)}))],2),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v(t._s(t.$t("switchDatabasePage.qu-xiao")))]),a("el-button",{attrs:{type:"primary"},on:{click:t.repairDbFromCluster}},[t._v(t._s(t.$t("switchDatabasePage.que-ding")))])],1)],1),a("div",{staticClass:"block",staticStyle:{float:"right"}},[a("el-pagination",{ref:"pagination",attrs:{layout:"total, sizes, prev, pager, next, jumper",total:t.total,"page-sizes":[20,30,40,50,100]},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1)}),[],!1,C,"325cd858",null,null);function C(t){for(let e in k)this[e]=k[e]}var S=function(){return x.exports}();const L={};var D=h({name:"replDelay",data:()=>({rows:[],tableRows:[],loading:!1,total:0,page:1,oldpage:1,size:10}),methods:{tableRowClassName:({row:t,rowIndex:e})=>e%2!=0?"warning-row":"success-row",handleSizeChange(t){this.size=t,this.oldpage=this.page,this.showReplyList()},handleCurrentChange(t){this.page=t,this.oldpage=this.page,this.showReplyList()},showReplyList:function(){let t=this;t.loading=!0;let i={page_size:t.$route.query.page_size,page_num:t.$route.query.page_num,cluster_id:t.$route.query.cluster_id};u.getReplyList(i).then((function(i){t.loading=!1,i&&i.rows&&(t.total=i.total,t.rows=i.rows,t.tableRows=t.rows.map((t=>{return i=o({},t),s={flush_delay:m(t.flush_delay),replay_delay:m(t.replay_delay),sent_delay:m(t.sent_delay),write_delay:m(t.write_delay)},e(i,a(s));var i,s})),console.log(t.tableRows),null!=t.$refs.pagination&&(t.$refs.pagination.internalCurrentPage=t.oldpage))}),(function(e){t.loading=!1}))}},mounted:function(){this.showReplyList()}},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",[a("el-col",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"row-class-name":t.tableRowClassName,data:t.tableRows,border:"","element-loading-text":t.$t("Public.ping-ming-jia-zai-zhong")}},[a("el-table-column",{attrs:{prop:"host",label:t.$t("replDelay.suozai-zhuji"),align:"center","min-width":"130px"}}),a("el-table-column",{attrs:{prop:"is_primary",label:t.$t("dbList.zhu-bei-ku"),align:"center","min-width":"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.is_primary?a("span",[t._v(" "+t._s(t.$t("replDelay.zhu")))]):t._e(),0===e.row.is_primary?a("span",[t._v(" "+t._s(t.$t("replDelay.bei")))]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"current_lsn",label:t.$t("replDelay.dangqian-lsn"),align:"center","min-width":"100px"}}),a("el-table-column",{attrs:{prop:"sent_delay",label:t.$t("replDelay.fasong-yanchi"),align:"center","min-width":"100px"}}),a("el-table-column",{attrs:{prop:"write_delay",label:t.$t("replDelay.xie-yan-chi"),align:"center","min-width":"100px"}}),a("el-table-column",{attrs:{prop:"flush_delay",label:t.$t("replDelay.shuaxin-yanshi"),align:"center","min-width":"100px"}}),a("el-table-column",{attrs:{prop:"replay_delay",label:t.$t("replDelay.zhenshi-yanshi"),align:"center","min-width":"100px"}}),a("el-table-column",{attrs:{prop:"is_sync",label:t.$t("replDelay.tong-bu"),align:"center","min-width":"100px"}}),a("el-table-column",{attrs:{prop:"repl_state",label:t.$t("replDelay.shiji-zhuangtai"),align:"center","min-width":"100px"},scopedSlots:t._u([{key:"default",fn:function(e){return["streaming"===e.row.repl_state?a("span",{staticClass:"el-icon-success green"},[t._v(" "+t._s(e.row.repl_state))]):"N/A"===e.row.repl_state?a("span",[t._v(" "+t._s(e.row.repl_state))]):a("span",{staticClass:"el-icon-error red"},[t._v(" "+t._s(e.row.repl_state))])]}}])})],1),a("div",{staticClass:"block",staticStyle:{float:"right"}},[a("el-pagination",{ref:"pagination",attrs:{layout:"total, sizes, prev, pager, next, jumper",total:t.total,"page-sizes":[20,30,40,50,100]},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1)}),[],!1,z,"71ea338c",null,null);function z(t){for(let e in L)this[e]=L[e]}var j=function(){return D.exports}();const R={};var q=h({name:"lastLSN",data:()=>({rows:[],loading:!1,total:0,page:1,size:10}),methods:{tableRowClassName:({row:t,rowIndex:e})=>e%2!=0?"warning-row":"success-row",handleSizeChange(t){this.size=t,this.showlastLSNList()},handleCurrentChange(t){this.page=t,this.showlastLSNList()},showlastLSNList:function(){let t=this;t.loading=!0;let e={page_size:t.$route.query.page_size,page_num:t.$route.query.page_num,cluster_id:t.$route.query.cluster_id};u.getLastLSNList(e).then((function(e){t.loading=!1,e&&e.rows&&(t.total=e.total,t.rows=e.rows),console.log(t.clusterInfoForm)}),(function(e){t.loading=!1}))}},mounted:function(){this.showlastLSNList()}},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{"row-class-name":t.tableRowClassName,data:t.rows,border:"","element-loading-text":t.$t("Public.ping-ming-jia-zai-zhong")}},[a("el-table-column",{attrs:{prop:"id",label:"ID",align:"center","min-width":"80px"}}),a("el-table-column",{attrs:{prop:"host",label:t.$t("replDelay.suozai-zhuji"),align:"center","min-width":"130px"}}),a("el-table-column",{attrs:{prop:"is_primary",label:t.$t("dbList.zhu-bei-ku"),align:"center","min-width":"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return[1===e.row.is_primary?a("span",[t._v(" "+t._s(t.$t("replDelay.zhu")))]):t._e(),0===e.row.is_primary?a("span",[t._v(" "+t._s(t.$t("replDelay.bei")))]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"timeline",label:"Timeline",align:"center","min-width":"100px"}}),a("el-table-column",{attrs:{prop:"lsn",label:"lsn",align:"center","min-width":"100px"}})],1)}),[],!1,P,"93d70d54",null,null);function P(t){for(let e in R)this[e]=R[e]}var N=function(){return q.exports}();const T={};var H=h({name:"dbList",inject:["reload"],components:{taskLog:_},data:()=>({rows:[],total:0,page:1,size:10,oldpage:1,loading:!1,clusterState:""}),methods:{tableRowClassName:({row:t,rowIndex:e})=>e%2!=0?"warning-row":"success-row",handleSizeChange(t){this.size=t,this.oldpage=this.page,this.showHostList()},handleCurrentChange(t){this.page=t,this.oldpage=this.page,this.showHostList()},showHostList:function(){let t=this;t.loading=!0;let e={page_size:this.$queryProps.page_size,page_num:this.$queryProps.page_num,cluster_id:this.$queryProps.cluster_id};u.getHostList(e).then((function(e){t.loading=!1,e&&e.rows&&(t.total=e.total,t.rows=e.rows,null!=t.$refs.pagination&&(t.$refs.pagination.internalCurrentPage=t.oldpage))}),(function(e){t.loading=!1}))},SdClusterSwitch:function(t,e){let a=this;a.loading=!0,this.$confirm(this.$t("polarDbEditHostList.ninqueding-yaojiangshujuku-qiehuandao-zhuji")+e.ip+this.$t("polarDbEditHostList.yunxingma-message"),this.$t("index.ti-shi"),{type:"warning",closeOnClickModal:!1}).then((()=>{let t={cluster_id:e.cluster_id,ip:e.ip};u.sdSwitch(t).then((function(t){a.loading=!1,a.$refs.tasklog.openDialog(t.task_id,a.showHostList,2),a.showHostList()}),(function(t){a.loading=!1}))})).catch((t=>{a.loading=!1}))},SdStartDatabase:function(t,e){let a=this;this.$confirm(this.$t("HostList.ninqueding-zaizhuji")+e.ip+this.$t("HostList.shang-qidongshujujku-ma"),this.$t("index.ti-shi"),{type:"warning",closeOnClickModal:!1}).then((()=>{a.loading=!0;let t={cluster_id:e.cluster_id,ip:e.ip};u.sdStartPostgres(t).then((function(t){a.loading=!1,a.showHostList()}),(function(t){a.loading=!1}))})).catch((t=>{}))},SdStopDatabase:function(t,e){let a=this;this.$confirm(this.$t("HostList.ninqueding-tingzhi-zhuji")+e.ip+this.$t("HostList.shangde-shujikuma"),this.$t("index.ti-shi"),{type:"warning",closeOnClickModal:!1}).then((()=>{a.loading=!0;let t={cluster_id:e.cluster_id,ip:e.ip};u.sdStopPostgres(t).then((function(t){a.loading=!1,a.showHostList()}),(function(t){a.loading=!1}))})).catch((t=>{}))}},mounted:function(){this.showHostList(),this.clusterState=this.$queryProps.state}},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",[a("el-col",[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"20px"},attrs:{"row-class-name":t.tableRowClassName,data:t.rows,border:"","element-loading-text":t.$t("Public.ping-ming-jia-zai-zhong")}},[a("el-table-column",{attrs:{prop:"ip",label:t.$t("polarDbEditHostList.jiqi-IP"),align:"center","min-width":"100px"}}),a("el-table-column",{attrs:{prop:"db_state",label:t.$t("dbList.shujuku-zhuangtai"),align:"center","min-width":"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return["运行"===e.row.db_state?a("span",[a("i",{staticClass:"el-icon-success green"}),t._v(" "),a("span",{staticClass:"statefont"},[t._v(t._s(t.$t("HostList.yun-xing")))])]):"无"===e.row.db_state?a("span",[a("i",{staticClass:"el-icon-remove black"}),t._v(" "),a("span",{staticClass:"statefont"},[t._v(t._s(t.$t("HostList.wu")))])]):"未知"===e.row.db_state?a("span",[a("i",{staticClass:"el-icon-error red"}),t._v(" "),a("span",{staticClass:"statefont"},[t._v(t._s(t.$t("dashboard.wei-zhi")))])]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"vip_state",label:t.$t("polarDbEditHostList.VIP-zhuangtai"),align:"center","min-width":"80px"},scopedSlots:t._u([{key:"default",fn:function(e){return["运行"===e.row.vip_state?a("span",[a("i",{staticClass:"el-icon-success green"}),t._v(" "),a("span",{staticClass:"statefont"},[t._v(t._s(t.$t("HostList.yun-xing")))])]):"无"===e.row.vip_state?a("span",[a("i",{staticClass:"el-icon-remove black"}),t._v(" "),a("span",{staticClass:"statefont"},[t._v(t._s(t.$t("HostList.wu")))])]):"未知"===e.row.vip_state?a("span",[a("i",{staticClass:"el-icon-error red"}),t._v(" "),a("span",{staticClass:"statefont"},[t._v(t._s(t.$t("dashboard.wei-zhi")))])]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"mount_state",label:t.$t("HostList.cipanguazai-zhuangtai"),align:"center","min-width":"80px"}}),a("el-table-column",{attrs:{prop:"is_primary",label:t.$t("dashboard.zhu-bei"),align:"center","min-width":"80px"}}),a("el-table-column",{attrs:{prop:"handle",label:t.$t("clusterDefine.caozuo"),align:"center","min-width":"165px"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("task-log",{ref:"tasklog"}),5!=t.clusterState?a("div",["备"===e.row.is_primary&&"未知"!==e.row.db_state?a("el-link",{attrs:{size:"mini"},on:{click:function(a){return t.SdClusterSwitch(e.$index,e.row)}}},[t._v(t._s(t.$t("HostList.shujuku-qiehuandao-cizhuji")))]):t._e(),"主"===e.row.is_primary&&"运行"===e.row.db_state?a("el-link",{attrs:{size:"mini"},on:{click:function(a){return t.SdStopDatabase(e.$index,e.row)}}},[t._v(t._s(t.$t("HostList.dingzhi-shujuku")))]):t._e(),"主"===e.row.is_primary&&"无"===e.row.db_state?a("el-link",{attrs:{size:"mini"},on:{click:function(a){return t.SdStartDatabase(e.$index,e.row)}}},[t._v(t._s(t.$t("HostList.qidong-shujuku")))]):t._e()],1):t._e()]}}])})],1),a("div",{staticClass:"block",staticStyle:{float:"right"}},[a("el-pagination",{ref:"pagination",attrs:{layout:"total, sizes, prev, pager, next, jumper",total:t.total,"page-sizes":[20,30,40,50,100]},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1)],1)}),[],!1,F,"547994f7",null,null);function F(t){for(let e in T)this[e]=T[e]}const O={};var E=h({name:"OperCluster",inject:["reload"],components:{clusterInfo:d,dbList:S,replDelay:j,lastLSN:N,HostList:function(){return H.exports}(),computerRoomConfig:c,polarcomputerRoomConfig:r,clusterRelation:v},data:()=>({activeName:"dbList",tabShow:!0,operShow:!1,dialogWidth:0,isSmallSidebar:1,row:{},clusterType:"",clusterName:"",Permission_repu:!1}),methods:{refresh(){console.log(this.clusterType);const t=this;t.clusterType,t.tabShow=!1,t.$nextTick((()=>t.tabShow=!0))},updateTable:function(){this.operShow=!1,this.$emit("refreshTable")},openDialog:function(t){const e=this;this.$router.push({query:{}});const a=((t,e)=>{var a={};for(var n in t)s.call(t,n)&&e.indexOf(n)<0&&(a[n]=t[n]);if(null!=t&&i)for(var n of i(t))e.indexOf(n)<0&&l.call(t,n)&&(a[n]=t[n]);return a})(this.$route.query,[]);e.clusterName=t.cluster_name,e.clusterType=t.cluster_type,this.$router.push({query:o(o({},a),t)}),0==document.getElementsByClassName("showSidebar").length?(e.isSmallSidebar=1,e.dialogWidth=document.body.clientWidth-60):(e.dialogWidth=document.body.clientWidth-180,e.isSmallSidebar=2),2===e.clusterType?e.activeName="HostList":e.activeName="dbList",e.operShow=!0,e.tabShow=!1,e.$nextTick((()=>e.tabShow=!0))}},mounted:function(){f.$on("Permission_repu",(t=>{this.Permission_repu=t}))}},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{ref:"queryLog",attrs:{title:t.$t("polarDbModifyCluster.xiangqing-jiqunmingcheng")+t.clusterName+")","append-to-body":!0,"custom-class":1==t.isSmallSidebar?"querylog querylogmin":"querylog querylogmax",modal:!1,width:t.dialogWidth+"px",top:"0",visible:t.operShow,"close-on-click-modal":!0},on:{close:t.updateTable,"update:visible":function(e){t.operShow=e}}},[a("el-row",{staticClass:"warp"},[a("el-col",{staticClass:"warp-breadcrum",attrs:{span:24}},[a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"small"},on:{click:t.refresh}},[t._v(t._s(t.$t("resourceManagement.shua-xin")))])],1),a("el-col",{staticClass:"warp-main",attrs:{span:24}},[1===t.clusterType||"1"===t.clusterType?[a("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:t.$t("polarDbModifyCluster.zhubei-shujuku"),name:"dbList"}}),a("el-tab-pane",{attrs:{label:t.$t("OperCluster.chakan-yanshi"),name:"replDelay"}}),a("el-tab-pane",{attrs:{label:t.$t("OperCluster.chakan-LSN"),name:"lastLSN"}}),t.Permission_repu?t._e():a("el-tab-pane",{attrs:{label:t.$t("polarDbModifyCluster.jifang-peizhi"),name:"computerRoomConfig"}}),a("el-tab-pane",{attrs:{label:t.$t("OperCluster.jiqun-tuoputu"),name:"clusterRelation"}})],1)]:t._e(),11===t.clusterType||"11"===t.clusterType?[a("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:t.$t("polarDbModifyCluster.zhubei-shujuku"),name:"dbList"}}),a("el-tab-pane",{attrs:{label:t.$t("OperCluster.chakan-yanshi"),name:"replDelay"}}),a("el-tab-pane",{attrs:{label:t.$t("OperCluster.chakan-LSN"),name:"lastLSN"}}),t.Permission_repu?t._e():a("el-tab-pane",{attrs:{label:t.$t("polarDbModifyCluster.jifang-peizhi"),name:"polarcomputerRoomConfig"}}),a("el-tab-pane",{attrs:{label:t.$t("OperCluster.jiqun-tuoputu"),name:"clusterRelation"}})],1)]:t._e(),21===t.clusterType||"21"===t.clusterType?[a("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:t.$t("polarDbModifyCluster.zhubei-shujuku"),name:"dbList"}}),a("el-tab-pane",{attrs:{label:t.$t("OperCluster.chakan-yanshi"),name:"replDelay"}}),a("el-tab-pane",{attrs:{label:t.$t("OperCluster.chakan-LSN"),name:"lastLSN"}}),a("el-tab-pane",{attrs:{label:t.$t("OperCluster.jiqun-tuoputu"),name:"clusterRelation"}})],1)]:2===t.clusterType||"2"===t.clusterType?[a("el-tabs",{model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:t.$t("ModifyCluster.zhubei-jiqi"),name:"HostList"}}),a("el-tab-pane",{attrs:{label:t.$t("createStreamReplicationCluster.jiqun-xinxi"),name:"clusterInfo"}})],1)]:t._e(),t.tabShow?a(t.activeName,{tag:"component"}):t._e()],2)],1)],1)}),[],!1,I,"3df0358e",null,null);function I(t){for(let e in O)this[e]=O[e]}var B=function(){return E.exports}();export{B as default};
